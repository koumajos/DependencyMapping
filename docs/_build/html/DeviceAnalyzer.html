
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>DeviceAnalyzer module &#8212; Passive Autodiscovery 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PassiveAutodiscovery module" href="PassiveAutodiscovery.html" />
    <link rel="prev" title="CreateScript module" href="CreateScript.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-DeviceAnalyzer">
<span id="deviceanalyzer-module"></span><h1>DeviceAnalyzer module<a class="headerlink" href="#module-DeviceAnalyzer" title="Permalink to this headline">¶</a></h1>
<p>DeviceAnalyzer script:</p>
<p>DeviceAnalyzer script connect to sqlite3 database which is created by CreateScript and filled by PassiveAutodiscovery script. After connect to database, script will analyzed database acccording to setted arguments of script. Only one mandatory output of the script is JSON document with default name PassiveAutodiscovery.</p>
<dl class="simple">
<dt>Analyze:</dt><dd><dl class="simple">
<dt>For all device will script get these information from database:</dt><dd><p>IP address of device (if mac address is use more IP address and isn’t router, it will be list of IP address where first one is for comunication analyzed in the section)
Time of last comunication
Labels of roles that device is (provides these services for other device on network)
DHCP records (requests and answers) by time.
List of local dependencies sorted by number of carryed packet. ()
Statistic of local dependencies by transport layer protocol.
List of global dependencies sorted by number of carryed packet.
Statistic of global dependencies by transport layer protocol.</p>
</dd>
<dt>For database can be created:</dt><dd><p>Graph of local dependencies. [-l]
Graph of local device and global devices, which local device communication with. [-g]
Graph of local devices and globla devices, where global device is in graph only if two or more local devices had communicate with. It will create bipartite graph. [-b]
Statistical of using network by devices.</p>
</dd>
</dl>
</dd>
<dt>Setting of the script:</dt><dd><dl class="simple">
<dt>Outputs:</dt><dd><p>JSON document - mandatory output, can be setted name of the document [-J name] (default name is PassiveAutodiscovery)
Command Line - optinional output [-p]
File .txt - optinional output, can be setted name of the document (hasn’t default value) [-f name]</p>
</dd>
<dt>Analyze:</dt><dd><p>Default state - analyze all database [without -D and -N]
Device - analyze only one inserted device (if exists in database) [-D]
Network - analyze only one network subnet [-N]</p>
</dd>
<dt>Number of dependencies in output to command line or File .txt (JSON document contains all dependencies):</dt><dd><p>Set the number of local dependencies. [-L]
Set the number of global dependencies. [-G]</p>
</dd>
<dt>Dependencies and device with label [WEB Server] can be translate to domain name:</dt><dd><p>The domain name will be in output (command line/file). [-DNS]</p>
</dd>
<dt>Can ignored global dependencies:</dt><dd><p>In outub will be only local dependencies. [-o]</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py function">
<dt id="DeviceAnalyzer.AnalyzeLocalDevice">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">AnalyzeLocalDevice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">TIME</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">JSON</span></em>, <em class="sig-param"><span class="n">IPStatistic</span></em>, <em class="sig-param"><span class="n">GL</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">sample</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.AnalyzeLocalDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze a device and output of it add to JSON document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – Number of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – Device IP address.</p></li>
<li><p><strong>TIME</strong> (<em>int</em>) – Time of last comunication.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>JSON</strong> (<em>JSON</em>) – JSON file loaded in python.</p></li>
<li><p><strong>IPStatistic</strong> (<em>dictionary</em>) – Dictionary contains statistic of using network by devices.</p></li>
<li><p><strong>GL</strong> (<em>bool</em>) – True if global dependencies exists.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the script.</p></li>
<li><p><strong>sample</strong> (<em>opened file</em>) – Output file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.AnalyzeNetwork">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">AnalyzeNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.AnalyzeNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze network subnet from arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the script.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.AnalyzeSingleDevice">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">AnalyzeSingleDevice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.AnalyzeSingleDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze single device from arguments. If isn’t in database print error and end. Else analyze it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the script.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.Arguments">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">Arguments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.Arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Arguments of the DeviceAnalyzer script.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>arguments</strong> – Setted arguments of the script.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>argparse</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.ConnectToDatabase">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">ConnectToDatabase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.ConnectToDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to sqlite3 database which analyze.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the script.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>SQLiteConnection</strong> – Connection to sqlite3 database with name from arguments.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sqlite3</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.DHCP">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">DHCP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">createJSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.DHCP" title="Permalink to this definition">¶</a></dt>
<dd><p>Funkcion finds for device all record of DHCP comunicationa nd set it to output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – ID of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.DoAnalyze">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">DoAnalyze</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.DoAnalyze" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze all “local” devices from database table LocalDevice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the script.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.GLOBALDEPENDENCIES">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">GLOBALDEPENDENCIES</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">DeviceIP</span></em>, <em class="sig-param"><span class="n">GlobalStatistic</span></em>, <em class="sig-param"><span class="n">IPStatistic</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">createJSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.GLOBALDEPENDENCIES" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for device find in database all global dependencies and set in to output JSON. Also create statistic of global dependencies and statistic of using network by deveices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – Number of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – Device IP address in format str.</p></li>
<li><p><strong>DeviceIP</strong> (<em>ipaddress</em>) – Device IP address in format ipaddress.</p></li>
<li><p><strong>GlobalStatistic</strong> (<em>dictionary</em>) – Statistic of local dependencies.</p></li>
<li><p><strong>IPStatistic</strong> (<em>dictionary</em>) – Statistic of using network by device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.GraphGlobalDependencies">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">GraphGlobalDependencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">JSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.GraphGlobalDependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Function create graph of global dependencies for each device. Then safe them to files named Graph_Global_[IP address].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>JSON</strong> (<em>JSON</em>) – JSON file loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.GraphLocalDependencies">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">GraphLocalDependencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">JSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.GraphLocalDependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Function create graph of local dependencies for IP address version 4 and IP address version 6. Then safe it to file named Graph_Local_[ip verison].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>JSON</strong> (<em>JSON</em>) – JSON file loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.GraphLocalToGlobal">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">GraphLocalToGlobal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">JSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.GraphLocalToGlobal" title="Permalink to this definition">¶</a></dt>
<dd><p>Function create graph of dependencies between local and global device, where global is only if two or more local device have communication with. Then safe them to files named Graph_GlobalsToLocals_[number]. (Graph are for visibility safe to more files by small number of devices)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>JSON</strong> (<em>JSON</em>) – JSON file loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.IPAddress">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">IPAddress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">createJSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.IPAddress" title="Permalink to this definition">¶</a></dt>
<dd><p>Function finds in database all IP address of the device (more then one only when device used both version of IP address or change IP address while monitoring network (DHCP)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of analyzed device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.LABELS">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">LABELS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">createJSON</span></em>, <em class="sig-param"><span class="n">JSON</span></em>, <em class="sig-param"><span class="n">GL</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.LABELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all labels (of roles/services) for device in database table LocalServices. Also create new label out of dependencies like [End Device].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – ID of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
<li><p><strong>JSON</strong> (<em>JSON</em>) – JSON file for all analyze loaded in python.</p></li>
<li><p><strong>GL</strong> (<em>bool</em>) – True if global dependencies exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.LOCALDEPENDENCIES">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">LOCALDEPENDENCIES</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">DeviceIP</span></em>, <em class="sig-param"><span class="n">LocalStatistic</span></em>, <em class="sig-param"><span class="n">IPStatistic</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">createJSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.LOCALDEPENDENCIES" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for device find in database all local dependencies and set in to output JSON. Also create statistic of local dependencies and statistic of using network by deveices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – Number of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – Device IP address in format str.</p></li>
<li><p><strong>DeviceIP</strong> (<em>ipaddress</em>) – Device IP address in format ipaddress.</p></li>
<li><p><strong>LocalStatistic</strong> (<em>dictionary</em>) – Statistic of local dependencies.</p></li>
<li><p><strong>IPStatistic</strong> (<em>dictionary</em>) – Statistic of using network by device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.MAC">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">MAC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">DeviceID</span></em>, <em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">createJSON</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.MAC" title="Permalink to this definition">¶</a></dt>
<dd><p>Find if for device IP is in database MAC address record in table MAC or table Routers. If in table MAC, the device with IP has this MAC address. If in Router, the device with IP has this MAC address or is behind router with this MAC address (Ussualy cant resolve this by program).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DeviceID</strong> (<em>int</em>) – ID of device in analyze.</p></li>
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.Main">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">Main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.Main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function call one of three function by arguments where it is set.</p>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.PrintDeviceFromJSON">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">PrintDeviceFromJSON</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">JSON</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.PrintDeviceFromJSON" title="Permalink to this definition">¶</a></dt>
<dd><p>Print device from output JSON document to command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JSON</strong> (<em>JSON</em>) – Ouput JSON document.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the DeviceAnalyzer script.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.PrintDeviceToFileFromJSON">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">PrintDeviceToFileFromJSON</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">JSON</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">sample</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.PrintDeviceToFileFromJSON" title="Permalink to this definition">¶</a></dt>
<dd><p>Print device from output JSON document to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JSON</strong> (<em>JSON</em>) – Ouput JSON document.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted arguments of the DeviceAnalyzer script.</p></li>
<li><p><strong>sample</strong> (<em>opened file</em>) – Opened output file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.StatProcent">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">StatProcent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Statistic</span></em>, <em class="sig-param"><span class="n">createJSON</span></em>, <em class="sig-param"><span class="n">TMP</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.StatProcent" title="Permalink to this definition">¶</a></dt>
<dd><p>Function receive dictionary. The dictionarz number of packets calculate and create from it procents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Statistic</strong> (<em>dictionary</em>) – The dictionary of statistic with protocols/devices and number of packets that was carryed in network by it.</p></li>
<li><p><strong>createJSON</strong> (<em>JSON</em>) – JSON file for device with DeviceID ID loaded in python.</p></li>
<li><p><strong>TMP</strong> (<em>int</em>) – Magic value represent the type of statistic (Local statistic == 0, Global statistic == 1, Network use statistic == 2).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.Stats">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">Stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">LocalStatistic</span></em>, <em class="sig-param"><span class="n">Dependency</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.Stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Function find if source or destination port of dependency isn’t some services in network. If yes, then the packet number carry the dependendy add in LocalStatistic to the services. (this create with cyclus counter of packet by protocol in network)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LocalStatistic</strong> (<em>dictionary</em>) – Disctionary of protocols and number packet taht was carry over network by protocols.</p></li>
<li><p><strong>Dependency</strong> (<em>array</em>) – The one dependency for count packets and protocols.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.plot">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the statistical graph of using network (by protocols or devices) in %. Only for output in command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>list</em>) – List of deveces/protocols with procent of use the network.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.read_json">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">read_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Read JSON document from file to prom data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Name of the output JSON document file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – JSON format in python.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>JSON</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="DeviceAnalyzer.write_json">
<code class="sig-prename descclassname">DeviceAnalyzer.</code><code class="sig-name descname">write_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DeviceAnalyzer.write_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Write JSON in python to JSON document file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>JSON</em>) – JSON file loaded in python filled with information.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output JSON document file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Passive Autodiscovery</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">PassiveAutodiscovery3</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Collector.html">Collector module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CreateScript.html">CreateScript module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">DeviceAnalyzer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="PassiveAutodiscovery.html">PassiveAutodiscovery module</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">PassiveAutodiscovery3</a><ul>
      <li>Previous: <a href="CreateScript.html" title="previous chapter">CreateScript module</a></li>
      <li>Next: <a href="PassiveAutodiscovery.html" title="next chapter">PassiveAutodiscovery module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Josef Koumar.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/DeviceAnalyzer.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>