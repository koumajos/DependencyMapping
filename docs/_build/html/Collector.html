
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Collector module &#8212; Passive Autodiscovery 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CreateScript module" href="CreateScript.html" />
    <link rel="prev" title="PassiveAutodiscovery3" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-Collector">
<span id="collector-module"></span><h1>Collector module<a class="headerlink" href="#module-Collector" title="Permalink to this headline">¶</a></h1>
<p>Collector script:</p>
<p>Collector script analyze IP flow that get from PassiveAutodiscovery module.</p>
<p>Collector get database connection, arguments and IP flow.
IP flow si analyzed and arguemnts specificate how to do it.
The analyze get information from IP flow and add them to sqlite3 database.</p>
<p>Collector function collector is call from PassiveAutodiscovery module.</p>
<dl class="py function">
<dt id="Collector.DHCP">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">DHCP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SRC_IP</span></em>, <em class="sig-param"><span class="n">DST_IP</span></em>, <em class="sig-param"><span class="n">SRC_PORT</span></em>, <em class="sig-param"><span class="n">DST_PORT</span></em>, <em class="sig-param"><span class="n">TIME</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.DHCP" title="Permalink to this definition">¶</a></dt>
<dd><p>If IP flow is DHCP traffic, then safe record of it to table DHCP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SRC_IP</strong> (<em>str</em>) – Source IP address of dependency.</p></li>
<li><p><strong>DST_IP</strong> (<em>str</em>) – Destination IP address of dependency.</p></li>
<li><p><strong>SRC_PORT</strong> (<em>int</em>) – Source port number of dependency.</p></li>
<li><p><strong>DST_PORT</strong> (<em>int</em>) – Destination prot of dependency.</p></li>
<li><p><strong>TIME</strong> (<em>int</em>) – Unix time of IP flow.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.DeleteGlobalDependencies">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">DeleteGlobalDependencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">PacketNumber</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.DeleteGlobalDependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete global dependencies from table Global that have number of packer smaller then number PacketNumber.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>PacketNumber</strong> (<em>int</em>) – Number of packet that is line for delete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.MAC">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">MAC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">MAC</span></em>, <em class="sig-param"><span class="n">TIME</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.MAC" title="Permalink to this definition">¶</a></dt>
<dd><p>If device is is in local segemnt, the module can rosolve his MAC address and add record of it to table MAC. If it’s router and behind it is local subnet (2 or more local device or one global device on this mac address (the same IP version)) add all record of this mac address from table MAC to table Router and add new record from this IP flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of the device.</p></li>
<li><p><strong>MAC</strong> (<em>str</em>) – MAC address of the device.</p></li>
<li><p><strong>TIME</strong> (<em>int</em>) – Unix time of the IP flow.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.MACAdd">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">MACAdd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">MAC</span></em>, <em class="sig-param"><span class="n">TIME</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.MACAdd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device.</p></li>
<li><p><strong>MAC</strong> (<em>str</em>) – MAC address of device.</p></li>
<li><p><strong>TIME</strong> (<em>int</em>) – Unix time of IP flow where was combiantion IP and MAC used.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.NewDependencies">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">NewDependencies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">table</span></em>, <em class="sig-param"><span class="n">SRC_IP</span></em>, <em class="sig-param"><span class="n">DST_IP</span></em>, <em class="sig-param"><span class="n">SRC_PORT</span></em>, <em class="sig-param"><span class="n">DST_PORT</span></em>, <em class="sig-param"><span class="n">PACKETS</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.NewDependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>If dependency (local or global) doesn’t exist, function will add record about it to database. Else function will find the record and update packet number on this dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>str</em>) – Table where record about dependency may be safed. (“Dependencies” - for dependencies between “local” devices, “Global” - for dependencies between “local” device and global device)</p></li>
<li><p><strong>SRC_IP</strong> (<em>str</em>) – Source IP address of dependency.</p></li>
<li><p><strong>DST_IP</strong> (<em>str</em>) – Destination IP address of dependency.</p></li>
<li><p><strong>SRC_PORT</strong> (<em>int</em>) – Source port number of dependency.</p></li>
<li><p><strong>DST_PORT</strong> (<em>int</em>) – Destination prot of dependency.</p></li>
<li><p><strong>PACKETS</strong> (<em>int</em>) – Number of packet carryed in dependency(single IP flow).</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.NewDevice">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">NewDevice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">TIME</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.NewDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>This funcion check if “local” device is in sqlite3 database table LocalDevice. If isn’t, add it to table. If is, update last comunication in record of it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of the local device.</p></li>
<li><p><strong>TIME</strong> (<em>int</em>) – Unix time of the IP flow.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.Routers">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">Routers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">MAC</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.Routers" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for adding record to table Routers. The record is MAC address of router and Ip address of device behind him or router himself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device behind router (or IP address of the router).</p></li>
<li><p><strong>MAC</strong> (<em>str</em>) – MAC address of router.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.Services">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">Services</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">IP</span></em>, <em class="sig-param"><span class="n">PORT</span></em>, <em class="sig-param"><span class="n">table</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.Services" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if port in IP flow is used by some role of device (services), if yes and if it is NOT in database, put record to sqlite3 database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IP</strong> (<em>str</em>) – IP address of device that comunicate on protocol with port number PORT.</p></li>
<li><p><strong>PORT</strong> (<em>int</em>) – Port number of used protocol.</p></li>
<li><p><strong>table</strong> (<em>str</em>) – Name of the table to safe potencial record (if device is  “local”: table == LocalServices, if device is “global”: table == GlobalServices).</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="Collector.collector">
<code class="sig-prename descclassname">Collector.</code><code class="sig-name descname">collector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rec</span></em>, <em class="sig-param"><span class="n">SQLiteConnection</span></em>, <em class="sig-param"><span class="n">cursor</span></em>, <em class="sig-param"><span class="n">arguments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Collector.collector" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function of this script. This function receive IP flow, database proms and arguments. Then work with received IP flow to get information from it and record of it safe (update) in sqlite3 database that received.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rec</strong> (<em>pytrap</em>) – Received IP flow to analyze.</p></li>
<li><p><strong>cursor</strong> (<em>sqlite3</em>) – Cursor to sqlite3 database for execute SQL queries.</p></li>
<li><p><strong>SQLiteConnection</strong> (<em>sqlite3</em>) – Connection to sqlite3 database.</p></li>
<li><p><strong>arguments</strong> (<em>argparse</em>) – Setted argument of the PassiveAutodiscovery module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Passive Autodiscovery</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">PassiveAutodiscovery3</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Collector module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CreateScript.html">CreateScript module</a></li>
<li class="toctree-l2"><a class="reference internal" href="DeviceAnalyzer.html">DeviceAnalyzer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="PassiveAutodiscovery.html">PassiveAutodiscovery module</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">PassiveAutodiscovery3</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">PassiveAutodiscovery3</a></li>
      <li>Next: <a href="CreateScript.html" title="next chapter">CreateScript module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Josef Koumar.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/Collector.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>